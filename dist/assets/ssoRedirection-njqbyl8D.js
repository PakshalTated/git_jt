import{r as a,a as N,b as k,t as R,j as e,k as j,ao as i}from"./index-b9OYvAdP.js";import"./module-C6tlsdyI.js";function L(){const[c,p]=a.useState(!0),{setIntegrationsConnection:l,integrationsConnection:u}=a.useContext(N),d=k(),[,s]=R(["userData","revspireToken","revspireRefreshToken","revspireLicense","revspirePermission"]);return a.useEffect(()=>{(async()=>{try{const t=new URLSearchParams(window.location.search),o=t.get("userData"),m=t.get("revspireToken"),g=t.get("revspireRefreshToken");s("userData",o,{path:"/",maxAge:604800,secure:!0,SameSite:"None"}),s("revspireToken",m,{path:"/",maxAge:86400,secure:!0,SameSite:"None"}),s("revspireRefreshToken",g,{path:"/",maxAge:2592e3,secure:!0,SameSite:"None"});const n=JSON.parse(decodeURIComponent(o)),h=n.user.id,v=n.organisation.tenant_api_name,f=n.organisation.domain,x=`https://${v}.${f}/login-information`,r=await j.post(x,{viewer_id:h});if(r.status===200&&r.data.success){const S=r.data.userLicenseInfo,w=r.data.userPermission;s("revspireLicense",S,{path:"/",maxAge:2592e3,secure:!0,SameSite:"None"}),s("revspirePermissions",w,{path:"/",maxAge:2592e3,secure:!0,SameSite:"None"}),l({...u,sso:!0}),i.success("SSO authentication successful!")}else throw new Error(r.data.message||"Failed to retrieve license and permission data")}catch(t){i.error("Something went wrong during authentication!!"),console.error(t)}finally{p(!1),d("/content/content-portal")}})()},[]),e.jsx("div",{className:"flex justify-center items-center h-screen",children:c?e.jsx("div",{className:`mini-logo ${active?"logoActive":""}`,children:e.jsx("div",{className:"app-container h-[500px] w-[900px]",children:e.jsx("div",{className:"loader-container h-full bg-cover w-full",children:e.jsx("img",{className:"logos h-full w-full bg-cover  bg-white p-2",src:logo,alt:"Logo"})})})}):e.jsx("div",{id:"pickedFiles"})})}export{L as default};

import{j as e,r as t,e as N,a as H,u as K,t as Ve,V as de,D as ee,l as ne,Z as as,B as ns,$ as Js,i as F,aq as Le,T as fs,L as Q,z as ze,ar as Me,k as Xs,G as Qs,ao as Z,H as os,M as et,as as st}from"./index-b9OYvAdP.js";import{u as tt,F as at,L as nt,C as ot,A as rt,E as rs,B as Te,f as ls,a as lt,b as it,c as ct,d as dt,S as mt,R as is,e as pt,g as xt,h as We,i as hs,j as gs,W as ut,k as ft,l as ht,m as gt,n as yt,o as bt,p as vt}from"./Dashboard-DSqmdOgz.js";import{q as _e,C as wt,D as jt,E as Nt,M as Ct,t as ys,s as bs,r as vs,p as Ae}from"./AnnotationLayer-CsQ9Me8w.js";import{F as P,Z as kt,p as Ft,_ as St,f as Dt,$ as It,a0 as Et,t as Lt,c as Tt,P as Ne,a1 as _t,a2 as At,C as cs,a3 as ds,a4 as ms,s as Ut}from"./index-9bYYq6UN.js";import{l as Ue,d as ws,c as js}from"./index-DSB5HKeL.js";import{M as Mt}from"./react-tooltip.min-_gtmIzAn.js";import{L as Ot,a as Ns}from"./index-DHI5Vo0j.js";import{B as qe}from"./Breadcrumbs-3Xb_fyMn.js";import{a as Rt}from"./index-VhyNO5SO.js";import{D as Bt}from"./DriveSelection-Bnr6ndBg.js";import"./module-C6tlsdyI.js";import"./ReactToastify-D-1G0H5q.js";import"./RevSpire-logo-BbDjnAdX.js";const Pt=({len:r=7})=>e.jsx("div",{role:"status",className:"w-full p-4 space-y-4 border border-gray-200 divide-y divide-gray-200 rounded shadow animate-pulse dark:divide-gray-700 md:p-6 dark:border-gray-700",children:Array.from({length:r}).map((i,c)=>e.jsxs("div",{className:"flex justify-start pt-4",children:[e.jsx("div",{className:"flex border border-gray-400 w-[220px] h-[120px] rounded-lg"}),e.jsx("div",{className:"flex border border-gray-400 w-[220px] h-[120px] rounded-lg ml-6"}),e.jsx("div",{className:"flex border border-gray-400 w-[220px] h-[120px] rounded-lg ml-6"}),e.jsx("div",{className:"flex border border-gray-400 w-[220px] h-[120px] rounded-lg ml-6"}),e.jsx("div",{className:"flex border border-gray-400 w-[220px] h-[120px] rounded-lg ml-6"})]},c))}),$t=r=>r.map(i=>({text:i,ref:t.useRef()}));function Vt({viewer_id:r,minCellWidth:i}){const[c,h]=t.useState(!0),l=N(s=>s.contents.breadcrumbs),[w,g]=t.useState(!0),[y,n]=t.useState({}),[f,m]=t.useState(""),[C,d]=t.useState(""),[I,k]=t.useState(!1),[T,D]=t.useState(""),[_,E]=t.useState(!1),[z,A]=t.useState(!1),[O,R]=t.useState(0),[o,L]=t.useState(""),[a,x]=t.useState(""),[q,se]=t.useState([]),[W,me]=t.useState(!1),[Ce,fe]=t.useState("white"),oe=t.useRef(null),ve=()=>{me(!1),se([])},pe=s=>{!s.mimetype||!s.mimetype.includes("image/")||m(s.id)},xe=s=>{!s.mimetype||!s.mimetype.includes("image/")||m("")};t.useEffect(()=>{x(l)},[]),t.useEffect(()=>{const s=setInterval(()=>{L(l)},100);return()=>clearInterval(s)},[l]);const{authURL:re,isMatchingCRMFound:le,isServiceUserConnected:he,setContentModalOpen:S,setViewContent:u,addTagToContent:M,contentModalLoading:Y,setContentModalLoading:Oe,folderPath:Ss,baseURL:ge,showButtonLoading:oa,setFolder_id:Ds,frontendBaseURL:Is,setFolderPath:ra,folder_id:ie,oneDrivePickerOpen:Ge,setOneDrivePickerOpen:ye}=t.useContext(H),ke=N(s=>s.contents.folder_id),[la,Es]=t.useState([]),{contents:Re,mouseMove:Fe,handleContentClick:He,sortRows:Se,mouseUp:Ke,sortConfig:ce,selectedContent:Ls,setSelectedContent:Ts}=tt({viewer_id:r,minCellWidth:i}),J=K();N(s=>s.filter.loadingTable);const[we]=Ve(["OneDriveData","OneDriveAccessToken","canvaAccessToken"]),_s=we.canvaAccessToken,As=()=>{S(!1)},Us=s=>{oe.current&&oe.current.classList.add("dragover"),s.preventDefault(),s.stopPropagation(),E(!0),fe("#e0e0e0")},Ms=s=>{oe.current&&oe.current.classList.remove("dragover"),s.preventDefault(),s.stopPropagation(),E(!1),fe("white")},Os=s=>{s.preventDefault()};t.useEffect(()=>{L(l),console.log("1 called"),a==o&&J(de({viewer_id:r,folder_id:ie,baseURL:ge}))},[ie,r,ge,J]);const Rs=s=>{const p=["jpg","jpeg","png","doc","docx","pdf","ppt","pptx","mp4","txt","xls","xlsx","mov"],b=s.name.split(".").pop().toLowerCase();return p.includes(b)},Ye=async s=>{console.log("folder id : ",ie);try{const p=await De.post("/view-content-and-folders-sorted",{viewer_id:r,folder_id:ie});console.log("response is:",p.data.items);const b=p.data.items.map(te=>te.name);console.log("File names in folder:",b);const v=s.name;console.log("checking for file : ",s.name);const U=b.includes(v);return console.log("file  exists? ",U),U?(console.log(`File "${v}" exists in the folder.`),!0):(console.log(`File "${v}" does not exist in the folder.`),!1)}catch(p){console.error("Error occurred:",p)}},Bs=s=>{let p=0;const j=b=>{if(p++,b.subFolders)for(const v of b.subFolders)j(v)};for(const b of s)j(b);return p},Ze=async(s,p,j)=>{let b=0,v=!1;for(const{file:U,folderPath:te}of s){const G=Je(te,p)||ke;try{await $s(U,G)}catch{v=!0,A(!0)}b++;const $=Math.floor(b/j*100);R($)}v?F.error("Content not uploaded successfully."):F.success("Content uploaded successfully!"),R(100),console.log("5 called"),console.log("currbreadcrumb: ",a),console.log("breadcrumb: ",o),a==o&&J(ee({viewer_id:r,folder_id:l[l.length-1].id,baseURL:ge}))},Je=(s,p,j="")=>{for(const b of p){const v=`${j}/${b.name}`;if(v===s)return b.id;if(b.subFolders&&b.subFolders.length>0){const U=Je(s,b.subFolders,v);if(U)return U}}return null},Ps=async(s,p,j,b)=>{try{return(await De.post("/create-nested-folders",{folderStructure:s,parent_folder:p,created_by:r},{withCredentials:!0})).data.folderStructure}catch(v){return console.error("Failed to create nested folders:",v),F.error("Failed to create nested folders."),null}};t.useEffect(()=>{if(O===100){const s=setTimeout(()=>{R(0)},2e3);return()=>clearTimeout(s)}},[O]);const $s=async(s,p=null)=>{const j=new FormData;j.append("files",s),j.append("created_by",r),j.append("description","Content"),p&&j.append("folder",p),await De.post("/local-upload",j,{headers:{"Content-Type":"multipart/form-data"},withCredentials:!0})},Vs=async s=>{s.preventDefault(),s.stopPropagation(),E(!1);const p=s.dataTransfer.items;let j=[],b=[],v=[],U=[];if(p){for(let $=0;$<p.length;$++){const V=p[$].webkitGetAsEntry();if(V.isDirectory){const B=await buildFolderStructure(V,b);B&&j.push(B)}else if(V.isFile){const B=p[$].getAsFile();if(!Rs(B)){v.push(B.name);continue}U.push(B)}}v.length>0&&(console.log("Invalid Files List",v),se(v),me(!0),v.length===1?F.error(`${v[0]} can't be uploaded`):F.error(`${v.length} files can't be uploaded`));const te=await zs(U);for(let $ of te)b.push({file:$,folderPath:"",folderId:ke});if(b.length===0){W&&F.error("No files selected for upload.");return}Es(b);const G=Bs(j)+b.length;if(b.length>1?F.loading(`Uploading ${b.length} files...`):b.length===1&&F.loading(`Uploading ${b[0].file.name}...`),j.length>0){const $=await Ps(j,ke);await Ze(b,$,G)}else await Ze(b,ke,G);F.dismiss(),F.success(`Successfully uploaded ${b.length} files.`)}},zs=async s=>{let p=[],j={};console.log("renaming called...");for(let b of s){let v=b.name;const U=v.substring(v.lastIndexOf("."))||"";let te=v.substring(0,v.lastIndexOf("."))||v,G=v,$=1,V=j[G]||await Ye({name:G});for(;V;)G=`${te} (${$})${U}`,$++,V=j[G]||await Ye({name:G});j[G]=!0;const B=new File([b],G,{type:b.type});p.push(B)}return p};t.useEffect(()=>{const s=we.OneDriveAccessToken,p=we.OneDriveData;var j;if(p&&(j=p.nameSpace),s&&Ge){Ds(Ss),J(ee({viewer_id:r,folder_id:ie,baseURL:ge}));let b;b=`https://${j}-my.sharepoint.com`,(U=>{console.log("Picker Being Opened from the ContentTile");const te=b;function G(...ae){return ae.map(X=>X.replace(/^[\\|/]/,"").replace(/[\\|/]$/,"")).join("/").replace(/\\/g,"/")}const $={sdk:"8.0",entry:{oneDrive:{files:{}}},authentication:{},messaging:{origin:Is,channelId:"27"},typesAndSources:{mode:"files",pivots:{oneDrive:!0,recent:!0}},selection:{mode:"multiple"}};let V=null,B=null;async function Ys(ae){V=window.open("","Picker","width=800,height=600");const X=new URLSearchParams({filePicker:JSON.stringify($)}),je=G(te,`_layouts/15/FilePicker.aspx?${X}`),ue=V.document.createElement("form");ue.setAttribute("action",je),ue.setAttribute("method","POST"),V.document.body.append(ue);const be=V.document.createElement("input");be.setAttribute("type","hidden"),be.setAttribute("name","access_token"),be.setAttribute("value",U),ue.appendChild(be),V.addEventListener("beforeunload",()=>{ye(!1)}),ue.submit(),window.addEventListener("message",Ee=>{if(Ee.source&&Ee.source===V){const ts=Ee.data;ts.type==="initialize"&&ts.channelId===$.messaging.channelId&&(B=Ee.ports[0],B.addEventListener("message",Zs),B.start(),B.postMessage({type:"activate"}))}})}async function Zs(ae){switch(ae.data.type){case"notification":console.log(`notification: ${ae.data}`);break;case"command":B.postMessage({type:"acknowledge",id:ae.data.id});const X=ae.data.data;switch(X.command){case"authenticate":const je=U;typeof je<"u"&&je!==null?B.postMessage({type:"result",id:ae.data.id,data:{result:"token",token:je}}):console.error(`Could not get auth token for command: ${JSON.stringify(X)}`);break;case"close":V.close(),ye(!1);break;case"pick":console.log(`Picked: ${JSON.stringify(X)}`);const ue=X.items.map(be=>be.id);Ws(ue),B.postMessage({type:"result",id:ae.data.id,data:{result:"success"}}),V.close(),ye(!1);break;default:console.warn(`Unsupported command: ${JSON.stringify(X)}`),B.postMessage({result:"error",error:{code:"unsupportedCommand",message:X.command},isExpected:!0}),ye(!1);break}break}}Ys()})(s)}},[Ge]);const De=ne(),Ws=async s=>{const p=localStorage.getItem("source_sync"),j=we.OneDriveData,b=we.OneDriveAccessToken,v=j.nameSpace;try{const U=await De.post("/onedrive-upload",{fileIDs:s,accessToken:b,nameSpace:v,created_by:r,folder_id:ie,...p==0&&{source_sync:p}});console.log(U.data),ye(!1),F.success("Content Added Successfully!")}catch(U){ye(!1),console.error("Error:",U),F.error("Failed to Add Content")}};t.useEffect(()=>{(()=>{const p=l.length>0?l[l.length-1]:null,j=p?p.id:ie||"";J(ee({viewer_id:r,folder_id:j,baseURL:ge,thumbnail:1}))})()},[J,l,r,ie,ge]);const Be=N(s=>s.contents.filterContents);N(s=>s.filter);const qs=N(s=>s.contents.loading),Ie=N(s=>s.contents.selectedItems),Xe=N(s=>s.contents.selectedContents);t.useState(118);const[Qe,ia]=t.useState(null),Gs=["checkbox","name","source","Created By","Created At","Updated By","Updated At",""],Pe=Re.map(s=>({...s,"Created At":s.created_at||"N/A","Created By":s.created_by||"N/A","Updated By":s.updated_by||"N/A","Updated At":s.updated_at||"N/A"}));$t(Gs);const Hs=(s,p)=>{n(j=>({...j,[s]:!0})),Ie.some(j=>j.id===s)?(J(ns(p)),n(j=>({...j,[s]:!1}))):J(as(p))},$e=t.useCallback(()=>{window.removeEventListener("mousemove",Fe),window.removeEventListener("mouseup",$e)},[Fe]);t.useEffect(()=>(Qe!==null&&(window.addEventListener("mousemove",Fe),window.addEventListener("mouseup",Ke)),()=>{$e()}),[Qe,Fe,Ke,$e]),t.useEffect(()=>{k(!!(le&&he&&!re))},[le,he,re]);const Ks=(s,p)=>{s.stopPropagation(),Hs(p.id,p)},es=(s,p)=>{s.stopPropagation(),He(p)},ss=s=>{s.stopPropagation()};return console.log("sortRows(transformedContents, sortConfig.key, sortConfig.direction)",Se(Pe,ce.key,ce.direction[1])),e.jsxs(e.Fragment,{children:[W&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-gray-500 bg-opacity-50",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-xl text-center",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Unsupported file types"}),e.jsxs("p",{className:"text-sm text-gray-500 mb-4",children:["The following files have unsupported file types:",e.jsx("br",{}),q.join(", ")]}),console.log("i am inside early: ",W),e.jsx(at,{onClickHandle:ve,label:"OK"}),console.log("i am inside : ",W)]})}),Y?e.jsxs("div",{className:"fixed inset-0 flex items-center justify-center z-50",children:[e.jsx("div",{className:"absolute bg-gray-800 opacity-50 inset-0"}),e.jsx(nt,{})]}):e.jsx(ot,{content:Ls,isOpen:S,closeModal:As,setSelectedContent:Ts}),M&&e.jsx(rt,{}),e.jsx("div",{className:"container overflow-auto",onDragOver:s=>{s.preventDefault(),s.stopPropagation()},onDragEnter:Us,onDragLeave:Ms,onDrop:Vs,onDragOver:Os,children:e.jsx("div",{className:"table-wrapper overflow-auto",children:e.jsx("div",{className:`mt-3 shadow-md border-2 tiles-container bg-white ${Re.length<8?"h-auto":"h-[650px] overflow-y-auto"}`,children:Be.filterApplied?Be.data.length===0?e.jsx(rs,{}):Se(Be.data,ce.key,ce.direction).map(s=>e.jsxs("div",{className:"tile",children:[e.jsxs("div",{className:"tile-header",children:[e.jsx("input",{id:`checkbox-table-${s.id}`,type:"checkbox",className:"h-4 rounded-bl-full bg-red-400 border-gray-300",checked:Xe.some(p=>p.id===s.id),onChange:()=>{const p=Xe.findIndex(j=>j.id===s.id);J(p===-1?as(s):ns(s))}}),e.jsxs("span",{className:"font-bold text-[#014d83]  cursor-pointer",onClick:()=>He(s),children:[s.table_identifier==="folder"?e.jsx(AiOutlineFolderOpen,{className:"w-4 h-4"}):s.mimetype==="application/pdf"?e.jsx(FaRegFilePdf,{className:"w-5 h-5"}):s.mimetype==="image/jpeg"||s.mimetype==="image/png"||s.mimetype==="image/svg+xml"?e.jsx(IoImagesOutline,{className:"w-5 h-5"}):s.mimetype==="application/vnd.ms-excel"?e.jsx(FaRegFileExcel,{className:"w-5 h-5"}):s.mimetype==="application/msword"?e.jsx(FaRegFileWord,{className:"w-5 h-5"}):s.mimetype==="application/vnd.openxmlformats-officedocument.presentationml.presentation"?e.jsx(Te,{className:"w-5 h-5"}):s.mimetype==="application/vnd.ms-powerpoint"?e.jsx(GrDocumentPpt,{className:"w-5 h-5"}):s.mimetype==="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"?e.jsx(LuFileSpreadsheet,{className:"w-5 h-5"}):s.mimetype==="application/vnd.openxmlformats-officedocument.wordprocessingml.document"?e.jsx(_e,{className:"w-5 h-5"}):s.mimetype==="application/url"?e.jsx(FiLink,{className:"w-5 h-5"}):s.mimetype==="application/octet-stream"?e.jsx(MdOutlineSlowMotionVideo,{className:"w-5 h-5"}):s.mimetype==="video/mp4"?e.jsx(MdOutlineSlowMotionVideo,{className:"w-5 h-5"}):e.jsx(Ue,{className:"w-5 h-5"}),e.jsx("span",{className:"truncate",children:s.name})]})]}),e.jsxs("div",{className:"tile-content",children:[e.jsxs("div",{className:"tile-item",children:[e.jsx("span",{className:"label",children:"Source:"})," ",s.source]}),e.jsxs("div",{className:"tile-item",children:[e.jsx("span",{className:"label",children:"Created By:"})," ",s.created_by]}),e.jsxs("div",{className:"tile-item",children:[e.jsx("span",{className:"label",children:"Created At:"})," ",ls(s.created_at)]}),e.jsxs("div",{className:"tile-item",children:[e.jsx("span",{className:"label",children:"Updated By:"})," ",s.updated_by]}),e.jsxs("div",{className:"tile-item",children:[e.jsx("span",{className:"label",children:"Updated At:"})," ",ls(s.updated_at)]}),e.jsxs("div",{className:"tile-item",children:[e.jsx(P,{icon:kt,"data-tooltip-id":"my-tooltips","data-tooltip-place":"right","data-tooltip-content":s.name}),e.jsx(Mt,{id:"my-tooltips",style:{backgroundColor:"rgb(8, 47, 73)",color:"#ffffff",zIndex:"100"},data:s.name})]})]})]},s.id)):qs?e.jsx(Pt,{}):Re.length===0?e.jsx(rs,{}):e.jsxs("div",{className:"grid justify-center items-center grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-4 p-4 mt-[10px]",children:[Se(Pe,ce.key,ce.direction).map((s,p)=>{Se(Pe,ce.key,ce.direction).length;const j=window.innerWidth>=1280?6:window.innerWidth>=1024?5:window.innerWidth>=768?4:window.innerWidth>=640?3:2,b=(p+1)%j===0;return e.jsx("div",{onMouseEnter:()=>pe(s),onMouseLeave:()=>xe(s),className:"relative group",children:e.jsxs("div",{onClick:v=>Ks(v,s),className:`hover:bg-gray-100 hover:shadow-md h-[180px] w-full flex flex-col justify-between items-center rounded transition-all duration-200 ${Ie.some(v=>v.id===s.id)?"border-blue-500 shadow-md":"border-gray-200"}`,children:[e.jsx("div",{className:`absolute top-2 left-2 w-6 h-6 rounded-full border-2 border-gray-300 flex items-center justify-center transition-opacity duration-200 ${Ie.some(v=>v.id===s.id)?"opacity-100":"opacity-0 group-hover:opacity-100"}`,children:Ie.some(v=>v.id===s.id)&&e.jsx("div",{className:"w-4 h-4 bg-[#024676] rounded-full"})}),e.jsxs("div",{className:"font-medium text-gray-700 cursor-pointer flex flex-col items-center w-full px-2 pt-4",children:[e.jsx("div",{className:"mb-2 h-[100px] w-[100px] flex items-center justify-center",onClick:v=>es(v,s),children:s.table_identifier==="folder"?e.jsx(wt,{className:"w-20 h-20 text-yellow-400"}):s.mimetype==="application/pdf"?e.jsx(lt,{className:"w-20 h-20 text-red-500"}):s.mimetype==="image/jpeg"||s.mimetype==="image/png"||s.mimetype==="image/svg+xml"?s.thumbnail?e.jsx("img",{className:"w-full h-full object-contain",src:`data:image/jpeg;base64,${btoa(String.fromCharCode(...new Uint8Array(s.thumbnail.data)))}`,alt:"thumbnail"}):e.jsx(jt,{className:"w-20 h-20 text-blue-400"}):s.mimetype==="application/vnd.ms-excel"?e.jsx(it,{className:"w-20 h-20 text-green-500"}):s.mimetype==="application/msword"?e.jsx(ct,{className:"w-20 h-20 text-blue-600"}):s.mimetype==="application/vnd.openxmlformats-officedocument.presentationml.presentation"?e.jsx(Te,{className:"w-20 h-20 text-orange-500"}):s.mimetype==="application/vnd.ms-powerpoint"?e.jsx(dt,{className:"w-20 h-20 text-orange-600"}):s.mimetype==="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"?e.jsx(mt,{className:"w-20 h-20 text-green-600"}):s.mimetype==="application/vnd.openxmlformats-officedocument.wordprocessingml.document"?e.jsx(_e,{className:"w-20 h-20 text-blue-700"}):s.mimetype==="application/url"?e.jsx(Nt,{className:"w-20 h-20 text-purple-500"}):s.mimetype==="application/octet-stream"?e.jsx(Ue,{className:"w-20 h-20 text-gray-500"}):s.mimetype==="video/mp4"?e.jsx(is,{className:"w-20 h-20 text-pink-500"}):e.jsx(is,{className:"w-20 h-20 text-pink-500"})}),e.jsx("span",{className:"text-center truncate w-full mt-2",title:s.name,onClick:v=>es(v,s),children:s.name.length>15?`${s.name.substring(0,15)}...`:s.name})]}),s.mimetype&&s.mimetype.includes("image/")&&e.jsxs("div",{className:"flex flex-col border-2 ",children:[I&&_s&&e.jsx("div",{className:"absolute top-1 right-0",onClick:ss,children:e.jsx(pt,{contentTils:c,item:s,activeContent:f,setActiveContent:m,showCanvaOptions:C,setShowCanvaOptions:d,lastColumn:b})}),I&&e.jsx("div",{className:"absolute top-1  right-6",onClick:ss,children:e.jsx(xt,{item:s,adobe:w,activeContent:f,setActiveContent:m,showAdobeOptions:T,setShowAdobeOptions:D,lastColumn:b})})]})]})},s.id)}),e.jsx(Js,{})]})})})})]})}function zt({folderModalOpen:r,setFolderModalOpen:i}){const{viewer_id:c,baseURL:h}=t.useContext(H),[l,w]=t.useState(""),[g,y]=t.useState(""),[n,f]=t.useState(!1),m=ne(),[C,d]=t.useState(!1),[I,k]=t.useState(!1),T=K();N(a=>a.contents.folder_id);const D=N(a=>a.contents.breadcrumbs),_=D[D.length-1].id,[E,z]=t.useState(_);t.useEffect(()=>{z(_)},[_]);const A=()=>{l.trim()===""?(y("Name is required!"),d(!0)):y("")},O=t.useRef(null),R=t.useCallback(async a=>{let x=a;k(!0),a.length>70&&(x=a.slice(0,70));try{f(!0);const q=await m.post("/create-folder",{parent_folder:_,name:x,created_by:c},{withCredentials:!0});F.success("Folder created successfully"),d(!1),f(!1),k(!1),T(ee({viewer_id:c,folder_id:_,baseURL:h}))}catch(q){console.error("Could not create folder",q),F.error("Adding Folder Failed"),f(!1),d(!1)}finally{i(!1),w(""),k(!1)}},[c,_,m,i,h]),o=()=>{i(!1),w(""),y("")},L=We([o]);return e.jsx("div",{children:r&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{ref:L,className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-md p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800 dark:text-gray-200",children:"Add Folder"}),e.jsx("button",{onClick:o,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 transition-colors",children:e.jsx(P,{icon:Ft})})]}),e.jsx("div",{className:"flex mb-4",children:e.jsx("div",{className:`flex w-full border rounded-md overflow-hidden focus-within:ring-2 focus-within:ring-sky-700 ${g?"border-red-500":"border-gray-300 dark:border-gray-600"}`,children:e.jsx("input",{type:"text",id:"name",value:l,onChange:a=>{d(!1),w(a.target.value),y("")},onKeyDown:a=>{if(a.key==="Enter"&&!n){const x=a.target.value.trim();x!==""?(R(x),A()):y("Name is required!")}},ref:O,required:!0,className:"flex-grow px-3 py-2 text-gray-700 dark:text-gray-200 bg-white dark:bg-gray-700 focus:outline-none",placeholder:"Enter folder name"})})}),g&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:g}),e.jsxs("div",{className:"flex justify-end mt-4 space-x-2",children:[e.jsx("button",{onClick:o,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-gray-400 dark:bg-gray-700 dark:text-gray-200 dark:hover:bg-gray-600",children:"Cancel"}),e.jsx("button",{disabled:C||n,onClick:()=>{const a=O.current.value.trim();a!==""?(R(a),A()):y("Name is required!"),d(!0)},className:"px-4 py-2 text-sm font-medium text-white bg-sky-700 rounded-md hover:bg-sky-800 focus:outline-none focus:ring-2 focus:ring-sky-500 disabled:opacity-50 disabled:cursor-not-allowed",children:I?e.jsx(Ot,{className:"animate-spin h-5 w-5 inline"}):"Save"})]})]})})})}function Wt(){const[r,i]=t.useState(!1),[c,h]=t.useState(!1),l=t.useRef(null),{setDriveSelection:w}=t.useContext(H),g=()=>{i(!r)},y=(f,m)=>{m.stopPropagation(),i(!1),f()};t.useEffect(()=>{const f=m=>{l.current&&!l.current.contains(m.target)&&i(!1)};return document.addEventListener("mousedown",f),()=>{document.removeEventListener("mousedown",f)}},[i]);const n=[{title:"Add Content",icon:e.jsx(P,{icon:St,className:"mr-3"}),onClick:()=>w(!0)},{title:"Add Folder",icon:e.jsx(P,{icon:Dt,className:"mr-3"}),onClick:()=>h(!0)}];return e.jsxs("div",{className:"absolute",ref:l,children:[e.jsxs(hs,{className:"mb-2 btn-secondary  mr-6 dark:bg-gray-700 dark:text-gray-200 dark:hover:bg-gray-600 ",onClick:g,children:[e.jsx(Ct,{className:"text-lg"}),"Add"]}),e.jsx("div",{className:`absolute mt-2 left-0 min-w-48 w-full p-3 px-4 text-base bg-neutral-100 border border-neutral-300 divide-y divide-gray-100 rounded-lg z-[999999] transition-all duration-300 ease-in-out transform ${r?"opacity-100 scale-100":"opacity-0 scale-95 pointer-events-none"}`,children:e.jsx("ul",{className:"flex flex-col ",children:n.map((f,m)=>e.jsxs("li",{className:"block px-4 py-2 text-sm text-neutral-700 hover:bg-neutral-200 cursor-pointer  border border-neutral-100 hover:border-neutral-300 rounded-lg active:scale-95 transition-all",onClick:C=>y(f.onClick,C),children:[f.src,f.icon,f.title]},m))})}),e.jsx(zt,{folderModalOpen:c,setFolderModalOpen:h})]})}function qt({setIsMoveButtonClicked:r}){const i=K(),{viewer_id:c,baseURL:h}=t.useContext(H),l=ne(),w=N(a=>a.contents.modalContents),g=N(a=>a.contents.modalLoading);N(a=>a.contents.modalLoading);const y=N(a=>a.contents.selectedItems),n=N(a=>a.contents.modalBreadCrumbs),[f,m]=t.useState(""),[C,d]=t.useState(!1),[I,k]=t.useState(!1),[T,D]=t.useState(!1),[_,E]=t.useState(!1);console.log("breadcrumbs",n[n.length-1].id),console.log("breadcrumbs",n),t.useEffect(()=>{y.length>1?E(!0):E(!1)},[y]);const z=async()=>{if(k(!0),D(!0),y.length===0){console.log("Invalid move request"),F.error("Invalid move request");return}try{const a=y.map(se=>se.id),x=n[n.length-1].id,q=await l.patch("/move-folder",{ids:a,moveFolderId:x,viewer_id:c},{withCredentials:!0});q.data.success?(F.success("Items moved successfully"),i(Q()),r(!1),i(ee({viewer_id:c,folder_id:x,baseURL:h})),i(ze({folderId:n[n.length-1].id,folderName:n[n.length-1].name}))):console.error("Move failed:",q.data.message)}catch(a){console.error("Error moving contents:",a),F.error("Error moving items, try again!")}finally{k(!1),D(!1)}},A=(a,x)=>{i(Le({folderId:x,folderName:a})),i(de({viewer_id:c,folder_id:x,baseURL:h}))},O=t.useCallback(async()=>{var x;if(!f){F.error("Folder name cannot be empty.");return}const a=(x=n[n.length-1])==null?void 0:x.id;try{if((await l.post("/create-folder",{parent_folder:a,name:f,created_by:c},{withCredentials:!0})).status===200)F.success("Folder created successfully"),m(""),d(!1),A(f,a);else throw new Error("Failed to create folder")}catch(q){console.error("Error creating folder:",q),F.error("Adding Folder Failed")}},[f,c,h,l,i]),R=a=>{i(Me(a)),i(de({viewer_id:c,folder_id:a[a.length-1].id,baseURL:h}))},L=We([()=>{r(!1)}]);return e.jsx("div",{children:e.jsxs("div",{className:"fixed inset-0 flex items-center justify-center z-50",children:[e.jsx("div",{className:"absolute inset-0 bg-black/50"}),e.jsxs("div",{ref:L,className:"bg-white rounded-lg z-10 w-[800px] shadow-xl",children:[e.jsx("div",{className:"p-6 pb-4",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("h2",{className:"text-xl",children:["Move ",y.length," ",y.length===1?"item":"items"]}),e.jsx("button",{onClick:()=>r(!1),className:"text-gray-400 hover:text-gray-600",children:"×"})]})}),e.jsxs("div",{className:"px-6 h-[52px]",children:[" ",C?e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"text",value:f,onChange:a=>m(a.target.value),placeholder:"Enter folder name",className:"flex-1 border border-[#0369a1] p-2 rounded focus:ring-2 focus:ring-[#0369a1] focus:border-transparent outline-none",autoFocus:!0}),e.jsx("button",{onClick:()=>{d(!1),m("")},className:"px-4 py-2 rounded bg-gray-100 hover:bg-gray-200 text-gray-600 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:O,className:"px-4 py-2 rounded bg-[#0369a1] text-white hover:bg-[#0284c7] transition-colors",children:"Create"})]}):e.jsxs("button",{className:"inline-flex items-center text-[#0369a1] hover:text-[#0284c7] transition-colors",onClick:()=>d(!0),children:[e.jsx("span",{className:"mr-1",children:"+"})," Create Folder"]})]}),e.jsxs("div",{className:"px-6",children:[e.jsx("div",{className:"mb-4",children:e.jsx(qe,{onBreadcrumbClick:Le,breadcrumbs:n,setBreadcrumbs:R})}),e.jsx("div",{className:"border border-gray-200 rounded",children:e.jsx("div",{className:"h-[300px] overflow-y-auto",children:g?e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-3 border-[#0369a1] border-t-transparent"})}):e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-100 shadow-md z-10 text-sm text-gray-600 sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left",children:"Name"}),e.jsx("th",{className:"px-6 py-3 text-left",children:"Source"}),e.jsx("th",{className:"px-6 py-3 text-left",children:"Created By"})]})}),e.jsx("tbody",{children:w.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"3",className:"text-center py-8 text-gray-500",children:"No items in this folder"})}):w.map(a=>e.jsxs("tr",{className:"border-t border-gray-100 hover:bg-gray-50 transition-colors",children:[e.jsxs("td",{className:a.parent_folder?"px-4 flex gap-2 py-2 truncate cursor-pointer hover:text-sky-500 w-64":"px-4 flex gap-2 py-2 truncate opacity-35 w-64",onClick:()=>a.parent_folder?A(a.name,a.id):null,children:[e.jsx("span",{children:a.table_identifier==="folder"?e.jsx(gs,{className:"text-yellow-300 w-5 h-5 flex-shrink-0",style:{width:"20px"}}):a.mimetype==="application/pdf"?e.jsx(ys,{className:"text-gray-500 w-5 h-5 flex-shrink-0",style:{width:"20px"}}):a.mimetype==="image/jpeg"||a.mimetype==="image/png"?e.jsx(bs,{className:"text-gray-500 w-5 h-5 flex-shrink-0",style:{width:"20px"}}):a.mimetype==="application/vnd.ms-excel"?e.jsx(ws,{className:"text-gray-500 w-5 h-5 flex-shrink-0",style:{width:"20px"}}):a.mimetype==="application/msword"?e.jsx(js,{className:"text-gray-500 w-5 h-5 flex-shrink-0",style:{width:"20px"}}):a.mimetype==="application/vnd.openxmlformats-officedocument.presentationml.presentation"?e.jsx(Te,{className:"text-gray-500 w-5 h-5 flex-shrink-0",style:{width:"20px"}}):a.mimetype==="application/vnd.ms-powerpoint"?e.jsx(vs,{className:"text-gray-500 w-5 h-5 flex-shrink-0",style:{width:"20px"}}):a.mimetype==="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"?e.jsx(Ns,{className:"text-gray-500 w-5 h-5 flex-shrink-0",style:{width:"20px"}}):a.mimetype==="application/vnd.openxmlformats-officedocument.wordprocessingml.document"?e.jsx(_e,{className:"text-gray-500 w-5 h-5 flex-shrink-0",style:{width:"20px"}}):a.mimetype==="application/url"?e.jsx(fs,{className:"text-gray-500 w-5 h-5 flex-shrink-0",style:{width:"20px"}}):a.mimetype==="video/mov"?e.jsx(Ae,{className:"text-gray-500 w-5 h-5 flex-shrink-0",style:{width:"20px"}}):a.mimetype==="video/mp4"?e.jsx(Ae,{className:"text-gray-500 w-5 h-5 flex-shrink-0",style:{width:"20px"}}):e.jsx(Ue,{className:"text-gray-500 w-5 h-5 flex-shrink-0",style:{width:"20px"}})}),a.name]}),e.jsx("td",{className:a.parent_folder?"px-4 py-2 cursor-pointer hover:text-sky-500 w-52":"px-4 py-2 opacity-35 w-52",children:a.source}),e.jsx("td",{className:a.parent_folder?"px-4 py-2 cursor-pointer hover:text-sky-500 w-52":"px-4 py-2 opacity-35 w-52",children:a.created_by})]},a.id))})]})})})]}),e.jsxs("div",{className:"flex justify-end gap-3 p-6 mt-4",children:[e.jsx("button",{onClick:()=>r(!1),className:"px-4 py-2 rounded bg-gray-100 hover:bg-gray-200 text-gray-600 transition-colors",children:"Cancel"}),e.jsx("button",{disabled:I,onClick:z,className:`px-4 py-2 rounded text-white transition-colors ${I?"bg-gray-400 cursor-not-allowed":"bg-[#014d83] hover:bg-[#015896]"}`,children:T?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"animate-spin h-4 w-4 border-2 border-white border-t-transparent rounded-full"}),e.jsx("span",{children:"Moving..."})]}):"Move Here"})]})]})]})})}const Gt=({viewer_id:r})=>{const[i,c]=t.useState(!1),{baseURL:h}=t.useContext(H),l=K(),w=N(n=>n.contents.breadcrumbs),g=N(n=>n.contents.folder_id),y=()=>{l(Me(w))};return e.jsxs(e.Fragment,{children:[e.jsxs("button",{type:"button",className:"flex items-center text-secondary text-[14px] py-1 px-2 my-2 rounded-md border-solid hover:bg-gray-200 dark:text-gray-200 dark:hover:bg-gray-700 dark:border-gray-500",onClick:()=>{c(!0),y(),l(de({viewer_id:r,folder_id:g,baseURL:h}))},children:[e.jsx(P,{icon:It,className:"mr-2"}),"Move"]}),i&&e.jsx(qt,{setIsMoveButtonClicked:c})]})};function Ht({setIsCopyButtonClicked:r}){const i=K(),c=ne(),{viewer_id:h,baseURL:l}=t.useContext(H),w=N(o=>o.contents.modalBreadCrumbs),g=N(o=>o.contents.selectedItems),y=N(o=>o.contents.modalContents),n=N(o=>o.contents.modalLoading),f=N(o=>o.contents.modalBreadCrumbs),[m,C]=t.useState(!1),[d,I]=t.useState(""),k=N(o=>o.contents.folder_id),[T,D]=t.useState(!1),[_,E]=t.useState(!1);t.useEffect(()=>{i(de({viewer_id:h,folder_id:k,baseURL:l}))},[i,h,l,k]);const z=async()=>{D(!0),E(!0);try{if(!g||g.length===0){F.error("Invalid copy location or no items selected.");return}const o=g.map(a=>a.id),L=f[f.length-1].id;await c.post("/duplicate-content",{folderId:L,contentIds:o,viewer_id:h}),r(!1),i(Q()),F.success("Copy Successful!"),i(ze({folderId:w[w.length-1].id,folderName:w[w.length-1].name}))}catch{F.error("Can't Copy Try Again")}finally{D(!1),E(!1)}},A=o=>{i(Me(o)),i(de({viewer_id:h,folder_id:o[o.length-1].id,baseURL:l}))},O=(o,L)=>{i(Le({folderId:L,folderName:o})),i(de({viewer_id:h,folder_id:L,baseURL:l}))},R=t.useCallback(async()=>{var L;if(!d){F.error("Folder name cannot be empty.");return}const o=(L=f[f.length-1])==null?void 0:L.id;try{const a=await c.post("/create-folder",{parent_folder:o,name:d,created_by:h},{withCredentials:!0});if(a.status===200)F.success("Folder created successfully"),console.log("res of folder :",a),I(""),C(!1),O(d,o);else throw new Error("Failed to create folder")}catch(a){console.error("Error creating folder:",a),F.error("Adding Folder Failed")}},[d,h,l,c,i]);return e.jsx("div",{children:e.jsxs("div",{className:"fixed inset-0 flex items-center justify-center z-50",children:[e.jsx("div",{className:"absolute inset-0 bg-black/50"}),e.jsxs("div",{className:"bg-white rounded-lg z-10 w-[800px] shadow-xl",children:[e.jsx("div",{className:"p-6 pb-4",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("h2",{className:"text-xl",children:["Copy ",g.length," ",g.length===1?"item":"items"]}),e.jsx("button",{onClick:()=>r(!1),className:"text-gray-400 hover:text-gray-600",children:"×"})]})}),e.jsx("div",{className:"px-6 h-[52px]",children:m?e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"text",value:d,onChange:o=>I(o.target.value),placeholder:"Enter folder name",className:"flex-1 border border-[#0369a1] p-2 rounded focus:ring-2 focus:ring-[#0369a1] focus:border-transparent outline-none",autoFocus:!0}),e.jsx("button",{onClick:()=>{C(!1),I("")},className:"px-4 py-2 rounded bg-gray-100 hover:bg-gray-200 text-gray-600 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:R,className:"px-4 py-2 rounded bg-[#0369a1] text-white hover:bg-[#0284c7] transition-colors",children:"Create"})]}):e.jsxs("button",{className:"inline-flex items-center text-[#0369a1] hover:text-[#0284c7] transition-colors",onClick:()=>C(!0),children:[e.jsx("span",{className:"mr-1",children:"+"})," Create Folder"]})}),e.jsxs("div",{className:"px-6",children:[e.jsx("div",{className:"mb-4",children:e.jsx(qe,{onBreadcrumbClick:Le,breadcrumbs:w,setBreadcrumbs:A})}),e.jsx("div",{className:"border border-gray-200 rounded",children:e.jsx("div",{className:"h-[300px] overflow-y-auto",children:n?e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-3 border-[#0369a1] border-t-transparent"})}):e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-100 shadow-md z-10 text-sm text-gray-600 sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left",children:"Name"}),e.jsx("th",{className:"px-6 py-3 text-left",children:"Source"}),e.jsx("th",{className:"px-6 py-3 text-left",children:"Created By"})]})}),e.jsx("tbody",{children:y.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"3",className:"text-center py-8 text-gray-500",children:"No items in this folder"})}):y.map(o=>e.jsxs("tr",{className:"border-t border-gray-100 hover:bg-gray-50 transition-colors",children:[e.jsxs("td",{className:o.parent_folder?"px-4 flex gap-2 py-2 truncate cursor-pointer hover:text-sky-500 w-64":"px-4 flex gap-2 py-2 truncate opacity-35 w-64",onClick:()=>o.parent_folder?O(o.name,o.id):null,children:[e.jsx("span",{children:o.table_identifier==="folder"?e.jsx(gs,{className:"text-yellow-300 w-5 h-5 flex-shrink-0",style:{width:"20px"}}):o.mimetype==="application/pdf"?e.jsx(ys,{className:"text-gray-500 w-5 h-5 flex-shrink-0",style:{width:"20px"}}):o.mimetype==="image/jpeg"||o.mimetype==="image/png"?e.jsx(bs,{className:"text-gray-500 w-5 h-5 flex-shrink-0",style:{width:"20px"}}):o.mimetype==="application/vnd.ms-excel"?e.jsx(ws,{className:"text-gray-500 w-5 h-5 flex-shrink-0",style:{width:"20px"}}):o.mimetype==="application/msword"?e.jsx(js,{className:"text-gray-500 w-5 h-5 flex-shrink-0",style:{width:"20px"}}):o.mimetype==="application/vnd.openxmlformats-officedocument.presentationml.presentation"?e.jsx(Te,{className:"text-gray-500 w-5 h-5 flex-shrink-0",style:{width:"20px"}}):o.mimetype==="application/vnd.ms-powerpoint"?e.jsx(vs,{className:"text-gray-500 w-5 h-5 flex-shrink-0",style:{width:"20px"}}):o.mimetype==="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"?e.jsx(Ns,{className:"text-gray-500 w-5 h-5 flex-shrink-0",style:{width:"20px"}}):o.mimetype==="application/vnd.openxmlformats-officedocument.wordprocessingml.document"?e.jsx(_e,{className:"text-gray-500 w-5 h-5 flex-shrink-0",style:{width:"20px"}}):o.mimetype==="application/url"?e.jsx(fs,{className:"text-gray-500 w-5 h-5 flex-shrink-0",style:{width:"20px"}}):o.mimetype==="video/mov"?e.jsx(Ae,{className:"text-gray-500 w-5 h-5 flex-shrink-0",style:{width:"20px"}}):o.mimetype==="video/mp4"?e.jsx(Ae,{className:"text-gray-500 w-5 h-5 flex-shrink-0",style:{width:"20px"}}):e.jsx(Ue,{className:"text-gray-500 w-5 h-5 flex-shrink-0",style:{width:"20px"}})}),o.name]}),e.jsx("td",{className:o.parent_folder?"px-4 py-2 cursor-pointer hover:text-sky-500 w-52":"px-4 py-2 opacity-35 w-52",children:o.source}),e.jsx("td",{className:o.parent_folder?"px-4 py-2 cursor-pointer hover:text-sky-500 w-52":"px-4 py-2 opacity-35 w-52",children:o.created_by})]},o.id))})]})})})]}),e.jsxs("div",{className:"flex justify-end gap-3 p-6 mt-4",children:[e.jsx("button",{onClick:()=>r(!1),className:"px-4 py-2 rounded bg-gray-100 hover:bg-gray-200 text-gray-600 transition-colors",children:"Cancel"}),e.jsx("button",{disabled:T,onClick:z,className:`px-4 py-2 rounded text-white transition-colors ${T?"bg-gray-400 cursor-not-allowed":"bg-[#014d83] hover:bg-[#015896]"}`,children:_?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"animate-spin h-4 w-4 border-2 border-white border-t-transparent rounded-full"}),e.jsx("span",{children:"Copying..."})]}):"Copy Here"})]})]})]})})}const Kt=t.memo(Ht),Yt=()=>{const r=K(),[i,c]=t.useState(!1),h=N(n=>n.contents.breadcrumbs),l=N(n=>n.contents.folder_id),{viewer_id:w,baseURL:g}=t.useContext(H),y=()=>{r(Me(h))};return e.jsxs(e.Fragment,{children:[e.jsxs("button",{type:"button",className:"flex items-center text-secondary text-[14px] py-1 px-2 my-2 rounded-md border-solid hover:bg-gray-200 dark:text-gray-200 dark:hover:bg-gray-700 dark:border-gray-500",onClick:()=>{c(!0),y(),r(de({viewer_id:w,folder_id:l,baseURL:g}))},children:[e.jsx(P,{icon:Et,className:"mr-2"}),"Copy"]}),i&&e.jsx(Kt,{setIsCopyButtonClicked:c})]})},Zt=t.memo(Yt),ps=({inDialog:r=!1})=>{const{viewer_id:i,baseURL:c}=t.useContext(H);ne();const h=K(),l=N(g=>g.contents.selectedItems),w=async()=>{let y=`contentIds=${l.map(m=>m.id).join(",")}&viewerId=${i}`;console.log(y);const n=new Promise(async(m,C)=>{try{const d=Xs.create();d.interceptors.response.use(_=>(m("File downloaded successfully!"),_));const I=await d.get(`${c}/download-files?${y}`,{responseType:"blob",withCredentials:!0}),k=l.length===1?l[0].name:"downloaded_files",T=I.headers["content-type"];let D="";switch(T){case"application/zip":D=".zip";break;case"application/pdf":D=".pdf";break}f(I.data,`${k}${D}`)}catch(d){console.error(d),C("Download failed!")}finally{h(Q())}});F.promise(n,{loading:"Downloading files...",success:m=>`${m}`,error:m=>`Failed: ${m}`});function f(m,C){const d=document.createElement("a");d.href=window.URL.createObjectURL(m),d.download=C,document.body.appendChild(d),d.click(),document.body.removeChild(d)}};return e.jsxs("button",{type:"button",className:"flex items-center text-secondary text-[14px] py-1 px-2 my-2 rounded-md border-solid hover:bg-gray-200 dark:text-gray-200 dark:hover:bg-gray-700 dark:border-gray-500",onClick:w,children:[e.jsx(P,{icon:Lt,className:"mr-2"}),"Download"]})},xs=({inDialog:r=!1})=>{const{viewer_id:i,baseURL:c}=t.useContext(H),h=ne(),l=K(),[w,g]=t.useState(!1),[y,n]=t.useState(!1),f=N(D=>D.contents.breadcrumbs),m=N(D=>D.contents.selectedItems),C=async D=>{const _=m.map(E=>E.id);try{if(n(!0),(await h.post(`${D}-for-deletion`,{ids:_,updated_by:i})).data.success){const z=D==="flag"?"Files deleted successfully.":"Refresh to view restored files.";F.success(z,{position:"top-right",autoClose:5e3,hideProgressBar:!0,closeOnClick:!1,pauseOnHover:!1,draggable:!1,progress:void 0,onClick:()=>C("unflag")}),l(Q()),l(ee({viewer_id:i,folder_id:f[f.length-1].id,baseURL:c}))}else F.error("An error occurred while performing the operation.")}catch(E){console.error(`Error occurred while ${D}ing:`,E.message),F.error("An error occurred while performing the operation.")}finally{g(!1),n(!1)}},d=D=>{C("flag")},I=()=>{g(!0)},T=We([()=>{g(!1)}]);return e.jsxs(e.Fragment,{children:[w&&e.jsx(ut,{title:"Are you sure?",content:"Deleting a content or a folder deletes all the tags or pitches affiliated with the contents .",onConfirm:d,onCancel:()=>g(!1),onEnter:d,modalRef:T,isLoading:y}),e.jsxs("button",{type:"button",className:"flex items-center text-secondary text-[14px] py-1 px-2 my-2 rounded-md border-solid hover:bg-gray-200 dark:text-gray-200 dark:hover:bg-gray-700 dark:border-gray-500",onClick:I,children:[e.jsx(P,{icon:Tt,className:"mr-2"}),"Delete"]})]})};function Jt(r){return Qs({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none"},child:[{tag:"path",attr:{d:"M16.3394 9.32245C16.7434 8.94589 16.7657 8.31312 16.3891 7.90911C16.0126 7.50509 15.3798 7.48283 14.9758 7.85938L12.0497 10.5866L9.32245 7.66048C8.94589 7.25647 8.31312 7.23421 7.90911 7.61076C7.50509 7.98731 7.48283 8.62008 7.85938 9.0241L10.5866 11.9502L7.66048 14.6775C7.25647 15.054 7.23421 15.6868 7.61076 16.0908C7.98731 16.4948 8.62008 16.5171 9.0241 16.1405L11.9502 13.4133L14.6775 16.3394C15.054 16.7434 15.6868 16.7657 16.0908 16.3891C16.4948 16.0126 16.5171 15.3798 16.1405 14.9758L13.4133 12.0497L16.3394 9.32245Z",fill:"currentColor"},child:[]},{tag:"path",attr:{fillRule:"evenodd",clipRule:"evenodd",d:"M1 12C1 5.92487 5.92487 1 12 1C18.0751 1 23 5.92487 23 12C23 18.0751 18.0751 23 12 23C5.92487 23 1 18.0751 1 12ZM12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12C21 16.9706 16.9706 21 12 21Z",fill:"currentColor"},child:[]}]})(r)}const Xt="/assets/versions-fileNotFound-Bslr7dks.png",Qt="/assets/onedrive-DXei0CKg.svg",ea="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2016%2016'%20id='google-drive'%3e%3cpath%20fill='%23FFC107'%20d='M10.667%2011H16L10.667%201H5.333z'%3e%3c/path%3e%3cpath%20fill='%232196F3'%20d='m4.952%2011-2.285%204H13.5l2.5-4z'%3e%3c/path%3e%3cpath%20fill='%234CAF50'%20d='M5.333%201%200%2010.333%202.667%2015l5.241-9.172z'%3e%3c/path%3e%3c/svg%3e",sa="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2048%2048'%20width='48px'%20height='48px'%3e%3clinearGradient%20id='YIohwmMMg1lAKHv~w_I_ua'%20x1='6.997'%20x2='40.749'%20y1='6.492'%20y2='41.247'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20offset='0'%20stop-color='%23ffd869'/%3e%3cstop%20offset='1'%20stop-color='%23fec52b'/%3e%3c/linearGradient%3e%3cpath%20fill='url(%23YIohwmMMg1lAKHv~w_I_ua)'%20d='M40,42H8c-1.1,0-2-0.9-2-2V8c0-1.1,0.9-2,2-2h32c1.1,0,2,0.9,2,2v32C42,41.1,41.1,42,40,42z'/%3e%3cpath%20fill='%23fff8e6'%20d='M19,6h10v5H19V6z'/%3e%3crect%20width='10'%20height='2'%20x='28'%20y='37'%20fill='%236b5f41'/%3e%3cpolygon%20fill='%236b5f41'%20points='38,32%2036,30%2034,32%2035,32%2035,35%2037,35%2037,32'/%3e%3cpolygon%20fill='%236b5f41'%20points='32,32%2030,30%2028,32%2029,32%2029,35%2031,35%2031,32'/%3e%3c/svg%3e",Cs=({onClose:r})=>{const[i,c]=t.useState(""),[h,l]=t.useState(!1),w=t.useRef(null),g=ne(),[y,n]=t.useState(null),[f,m]=t.useState(""),C=t.useRef(null),I=N(S=>S.contents.selectedItems)[0].id,{viewer_id:k,folder_id:T,baseURL:D,frontendBaseURL:_,selectedOrganisationId:E,setOneDrivePickerOpen:z}=t.useContext(H),A=K(),[O,R]=t.useState(!1),[o,L]=t.useState(""),[a,x]=t.useState([]),q=N(S=>S.contents.breadcrumbs),[se,W]=t.useState(!1),[me,Ce]=Ve(["OneDriveAccessToken"]),[fe,oe]=t.useState(!1),ve=["One Drive","Google Drive","Local Drive"];t.useEffect(()=>{g.post("/view-authorised-namespace",{viewer_id:k,organisation_id:E}).then(S=>{S.data.data.length===1?L(S.data.data[0].namespace):x(S.data.data)}).catch(S=>{console.error("Failed to fetch namespace",S)})},[k]);const pe=async()=>{const S=localStorage.getItem("versionUpload");if(console.log("versionuplaod before : ",S),me.OneDriveAccessToken)z(!0);else if(o)try{const Oe=(await g.get("/onedrive-auth",{params:{nameSpace:o,subdomainURL:_,folderPath:q,viewer_id:k}})).data;console.log("res data: ",Oe),window.location.href=Oe}catch(Y){console.error("Error starting OneDrive authentication:",Y)}else W(!0);const M=localStorage.getItem("versionUpload");console.log("versionuplaod after : ",M)},xe=S=>{c(S),oe(S==="One Drive"||S==="Google Drive"),console.log("setSelectedDrive",i),console.log("selected method",S),S=="One Drive"?localStorage.setItem("versionUpload",1):S==="Local Drive"?l(!0):S=="Google Drive"||(localStorage.setItem("versionUpload",0),l(!1),r())},re=()=>{C.current.click()},le=S=>{const u=S.target.files[0];u&&(n(u),m(u.name))},he=async S=>{if(S.preventDefault(),!y){Z.error("Please select a file to upload");return}R(!0);const u=new FormData;u.append("created_by",k),u.append("folder",T),u.append("description","Content"),u.append("version_parent",I),u.append("files",y);const M=Z.loading("Uploading Your Files....");try{const Y=await g.post("/local-version-upload",u,{headers:{"Content-Type":"multipart/form-data"}});Z.remove(M),Y.status===200?Z.success("Files uploaded successfully"):Z.error("Failed to upload the files")}catch(Y){console.error("Error:",Y),Z.remove(M),Z.error("Error uploading the files")}finally{R(!1),A(ee({viewer_id:k,folder_id:T,baseURL:D})),r()}};return e.jsx("div",{className:"fixed inset-0 z-50 bg-gray-600 bg-opacity-50 flex justify-center items-center",children:e.jsxs("div",{ref:w,className:"bg-white p-6 rounded-lg shadow-lg w-96",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Upload New Version"}),e.jsx("p",{children:"Select an upload method:"}),e.jsxs("table",{className:"mt-4 w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{}),e.jsx("th",{className:"px-16 py-3 text-left text-xs font-bold text-gray-500 uppercase tracking-widest",children:"Select Drive"})]})}),e.jsx("tbody",{children:ve.map((S,u)=>e.jsxs("tr",{onClick:()=>xe(S),className:"bg-gray-100 cursor-pointer hover:bg-white mb-2 pb-2",children:[e.jsx("td",{className:"pb-2",children:e.jsx("img",{className:"pl-4 h-[3rem] w-[3rem]",src:S==="One Drive"?Qt:S==="Google Drive"?ea:sa,alt:S})}),e.jsx("td",{className:"px-16 py-3 whitespace-nowrap",children:S})]},u))})]}),h?e.jsxs("form",{onSubmit:he,className:"flex flex-col items-center",children:[e.jsx("input",{type:"file",ref:C,onChange:le,className:"hidden",accept:".pdf,.doc,.docx,.txt,.jpeg,.png"}),e.jsxs("div",{className:"flex flex-col gap-2 mt-4",children:[e.jsx("div",{className:"flex ml-1 mb-1 overflow-hidden",children:f&&e.jsxs("div",{className:"text-xs flex flex-row items-center border border-cyan-100 px-2 py-1 rounded-md bg-cyan-50 text-cyan-800",children:[e.jsx("p",{className:"font-medium text-[15px] p-1",children:"File name:"}),e.jsx("span",{className:"ml-1 text-[15px]",children:f})]})}),e.jsxs("div",{className:"flex justify-center items-center gap-2",children:[f?e.jsx("button",{type:"submit",className:"btn-primary relative  flex items-center justify-center w-40 h-[35px]",onSubmit:r,disabled:O,children:O?"Uploading...":"Upload"}):e.jsx(hs,{type:"button",onClick:re,className:"btn-primary relative flex w-40 h-[35px]",children:"Browse"}),e.jsx("button",{className:"flex w-40 h-[35px] px-16 text-sm justify-center items-center rounded-xl border border-solid border-red-500 bg-red-100 hover:bg-red-200 text-red-800",onClick:r,children:"Cancel"})]})]})]}):e.jsxs("div",{className:"flex justify-center items-center gap-4 mt-4",children:[fe&&e.jsx("button",{className:"btn-primary relative  flex items-center justify-center w-40 h-[35px]",onClick:pe,children:"Authorize"}),e.jsx("button",{className:"flex w-40 h-[35px] px-16 text-sm justify-center items-center rounded-xl border border-solid border-red-500 bg-red-300 hover:bg-red-200 text-red-800",onClick:()=>{localStorage.setItem("versionUpload",0),r()},children:"Cancel"})]})]})})};Cs.propTypes={onClose:Ne.func.isRequired};const ks=({onClose:r})=>{const[i,c]=t.useState([]),[h,l]=t.useState(!1),[w,g]=t.useState(null),y=N(a=>a.contents.selectedItems),n=y[0].id,f=n,{viewer_id:m,folder_id:C,baseURL:d}=t.useContext(H),[I,k]=t.useState(!0),T=K(),[D,_]=t.useState(!1),E=ne(),z=async()=>{try{k(!0);const a=await E.post("/retrieve-content-versions",{content_id:f,viewer_id:m});a.data.success&&c(a.data.content)}catch(a){console.error("Error fetching versions:",a),console.log("Error in Version Modal")}finally{k(!1)}};t.useEffect(()=>{z()},[n]);const A=a=>{g(a),console.log("Version to revert",a),l(!0)},O=async()=>{if(w){console.log(`Reverting to ${w.version}`);try{const a=await E.post("/revert-content-version",{content_id:n,revert_content_id:w.id,viewer_id:m});a.status===200?(console.log(`Successfully reverted to version: ${w.version}`),Z.success("Successfully reverted"),l(!1),r(),z()):(console.error("Failed to revert version:",a.data.message),Z.error("Failed to revert"))}catch(a){console.error("Error reverting version:",a),Z.error("Internal server error")}}else Z.error("Please select a version to revert to");l(!1),r(),console.log("viewerid:",m),console.log("folderid",C),T(ee({viewer_id:m,folder_id:C,baseURL:d}))};t.useEffect(()=>{T(ee({viewer_id:m,folder_id:C,baseURL:d}))},[T,m,d,C]);const R=async()=>{console.log("Adding new version"),console.log("Viwer Id is:",m),console.log("File id is :",n),console.log("Folder id is :",C),console.log("Version parent id is:",n),_(!0)},o=()=>{_(!1),r()},L=i.length>1?[...i].sort((a,x)=>new Date(x.updated_at)-new Date(a.updated_at)).slice(1):i;return e.jsxs("div",{className:"fixed inset-0 flex items-center justify-center z-50",children:[e.jsx("div",{className:"absolute inset-0 bg-black opacity-50",onClick:r}),e.jsxs("div",{className:"relative bg-white p-6 rounded-lg shadow-lg z-10 max-w-4xl h-[80vh] flex flex-col",style:{minWidth:"700px"},children:[" ",e.jsxs("div",{className:"flex flex-col flex-grow overflow-hidden",children:[e.jsx("h2",{className:"text-xl mb-4 font-bold",children:"Version History"}),e.jsx("div",{className:"flex",children:e.jsxs("div",{className:"text-xs flex items-center border border-cyan-100 px-2 py-1 rounded-md bg-cyan-50 text-cyan-800",children:[e.jsx("p",{className:"font-medium text-[15px] p-1",children:"File name:"}),e.jsx("span",{className:"ml-1 text-[15px]",children:y[0].name})]})}),I?e.jsx("div",{className:"flex items-center justify-center flex-grow",children:e.jsx("div",{className:"text-xl text-gray-600 font-semibold tracking-wider animate-pulse",children:"Loading..."})}):e.jsxs("div",{className:"mt-4 flex-grow overflow-y-auto",children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Available Versions"}),i.length===1?e.jsxs("div",{className:"flex flex-col justify-center items-center mt-10",children:[e.jsx("img",{src:Xt,alt:"No versions",height:400,width:400}),e.jsx("div",{className:"text-lg font-semibold text-gray-400 mt-8 tracking-wide",children:"There are no versions available, add one to see."})]}):e.jsx("ul",{className:"list-disc pl-5",children:L.map((a,x)=>e.jsx("li",{className:"mb-4",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-semibold",children:`V1.${L.length-1-x}`}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Updated at: ",new Date(a.updated_at).toLocaleString()]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Created by: ",a.created_by_name]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Updated by: ",a.updated_by_name]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Description: ",a.description||"No description available"]})]}),e.jsx("div",{className:"flex ml-2",children:e.jsx("button",{onClick:()=>A(a),className:"flex justify-center items-center text-sm btn-primary text-white rounded-lg flex-1 transition-colors",children:"Revert"})})]})},a.id))})]})]}),e.jsxs("div",{className:"flex items-center justify-between gap-4 mt-4",children:[e.jsx("button",{onClick:R,className:"flex justify-center items-center text-sm btn-secondary text-white rounded-lg flex-1 transition-colors",children:"Add Version"}),e.jsx("button",{onClick:r,className:"px-6 py-2 text-sm text-red-600 bg-red-100 rounded-lg hover:bg-red-200 transition-colors border border-red-200 flex-1",children:"Close"})]})]}),D&&e.jsx(Cs,{onClose:o}),h&&e.jsx(Fs,{onClose:()=>l(!1),onConfirm:O,version:w})]})};ks.propTypes={onClose:Ne.func.isRequired};const Fs=({onClose:r,onConfirm:i})=>e.jsxs("div",{className:"fixed inset-0 flex items-center justify-center z-50",children:[e.jsx("div",{className:"absolute inset-0 bg-black opacity-50",onClick:r}),e.jsxs("div",{className:"relative bg-white p-6 rounded-md shadow-lg z-10 max-w-md mx-auto",children:[e.jsx("h2",{className:"text-xl mb-4",children:"Confirm Revert"}),e.jsx("p",{children:"Are you sure you want to revert to a previous version ?"}),e.jsxs("div",{className:"mt-4 flex justify-end gap-4",children:[e.jsx("button",{onClick:i,className:"bg-cyan-500 hover:bg-cyan-600 text-white p-2 rounded-md",children:"Yes, Revert"}),e.jsx("button",{onClick:r,className:"px-6 py-2 text-sm text-red-600 bg-red-100 rounded-lg hover:bg-red-200 transition-colors border border-red-200",children:"Cancel"})]})]})]});Fs.propTypes={onClose:Ne.func.isRequired,onConfirm:Ne.func.isRequired,version:Ne.object.isRequired};const ta=()=>{const[r,i]=t.useState(!1),{viewer_id:c,contentId:h}=t.useContext(H),l=N(n=>n.contents.folder_id),w=K(),g=()=>{console.log("Version clicked"),console.log("Viewer id :",c.viewer_id),console.log("Folder id :",l),console.log("content :",h),i(!0)},y=()=>{w(Q([])),i(!1)};return e.jsxs(e.Fragment,{children:[e.jsxs("button",{type:"button",className:"flex items-center text-secondary text-[14px] py-0 px-2 my-2 rounded-md border-solid hover:bg-gray-200 dark:text-gray-200 dark:hover:bg-gray-700 dark:border-gray-500",onClick:g,children:[e.jsx(P,{icon:_t,className:"mr-2"}),"Show Versions"]}),r&&e.jsx(ks,{onClose:y})]})},us=["image/jpeg","image/png","image/heic","image/gif","image/tiff","image/webp"],aa=()=>{const[r,i]=t.useState(!0),[c,h]=t.useState(!1),[l,w]=t.useState(window.innerWidth),g=t.useRef(null),y=t.useRef(null),n=ft(),f=ne(),{setRenameModalOpen:m,TableNameHandler:C,setAddTagToContent:d,viewer_id:I,setShowButtonLoading:k,baseURL:T,authURL:D,isMatchingCRMFound:_,isServiceUserConnected:E}=t.useContext(H),[z]=Ve(["canvaAccessToken"]),A=K(),[O,R]=t.useState(!1),[o,L]=t.useState(!1),a=N(u=>u.contents.selectedContents);N(u=>u.contents.selectedFolders);const x=N(u=>u.contents.selectedItems),q=N(u=>u.filter.filterApplied),se=t.useRef(null),[W,me]=t.useState(!0),Ce=!x.some(u=>u.source==="Public URL");t.useEffect(()=>{const u=M=>{se.current&&!se.current.contains(M.target)&&L(!1)};return o&&document.addEventListener("mousedown",u),()=>{document.removeEventListener("mousedown",u)}},[o]);const fe=async()=>{if(x.length!==1){F.error("Please select only one item for Canva upload.");return}const u=x[0];if(!us.includes(u.mimetype)||u.canva_id!==null){F.error("Selected item is not eligible for Canva upload.");return}const M=z.canvaAccessToken;if(!M){F.error("Canva access token not found. Please authenticate with Canva.");return}try{k(!0),(await f.post("/uploadToCanva",{contentId:u.id,accessToken:M,viewer_id:I})).status===200?L(!0):F.error("Failed to upload content to Canva.")}catch(Y){console.error("Error uploading to Canva:",Y),F.error("An error occurred while uploading to Canva.")}finally{k(!1)}},oe=()=>{me(!!(!D&&_&&E))};t.useEffect(()=>{R(x.length===1&&us.includes(x[0].mimetype)&&x[0].canva_id===null)},[x]),t.useEffect(()=>{oe()},[_,E,D]);const ve=()=>{i(u=>{const M=!u;return localStorage.setItem("myTils",M),window.dispatchEvent(new Event("storageUpdated")),M})};t.useEffect(()=>{const u=()=>{const M=localStorage.getItem("myTils");i(M==="true")};return u(),window.addEventListener("storageUpdated",u),window.addEventListener("storage",u),()=>{window.removeEventListener("storageUpdated",u),window.removeEventListener("storage",u)}},[]),t.useEffect(()=>{const u=()=>w(window.innerWidth);return window.addEventListener("resize",u),()=>window.removeEventListener("resize",u)},[l]);const pe=x.length===1&&l<1500,xe=x.length===1&&l<1400,re=x.length===1&&l<1300,le=x.length===1&&l<1200,he=u=>{u.stopPropagation(),h(!c)},S=()=>{h(!1)};return t.useEffect(()=>{const u=M=>{g.current&&!g.current.contains(M.target)&&y.current&&!y.current.contains(M.target)&&S()};return document.addEventListener("mousedown",u),()=>{document.removeEventListener("mousedown",u)}},[]),e.jsxs("div",{children:[e.jsxs("div",{className:"container flex justify-between mx-auto px-4 pt-4 w-full flex-nowrap ",children:[e.jsx("div",{className:"overflow-x-auto scroll-none flex flex-row",children:e.jsxs("div",{className:"flex justify-between ",children:[e.jsx("div",{className:"flex space-x-1 transition-all mb-3",children:n("Create Content")=="1"&&!q&&x.length===0&&W&&e.jsx("div",{className:"transition-all",children:e.jsx(Wt,{})})}),e.jsxs("div",{className:`flex transition-all ${x.length>0?"bg-white dark:bg-gray-600 rounded-md  shadow-md w-[60vw] pl-2":""}`,children:[(pe||xe||re||le)&&x.length>0?e.jsx("div",{className:"relative",children:e.jsx("button",{ref:y,className:"flex text-sky-800 text-[14px] mt-2 px-3 py-2 ml-2  rounded-md border-solid hover:bg-gray-200 dark:text-gray-200 dark:hover:bg-gray-700 dark:border-gray-500",onClick:he,children:e.jsx(P,{icon:At,className:" mt-2"})})}):"",n("Edit Content")=="1"&&x.length===1&&W&&e.jsx("div",{className:"transition-all",children:e.jsx(ht,{onClick:()=>{m(!0)}})}),a.length>0&&a.length===x.length&&e.jsx("div",{className:"flex",children:n(";Add Tag to Content")=="1"&&x.length===1&&W&&e.jsx("div",{children:e.jsxs("button",{className:"flex items-center text-secondary text-[14px] py-1 px-2 my-2 rounded-md border-solid hover:bg-gray-200 dark:text-gray-200 dark:hover:bg-gray-700 dark:border-gray-500",onClick:()=>{d(!0),A(os({viewer_id:I,baseURL:T}))},children:[e.jsx(P,{icon:cs,className:"mr-1"}),"Add Tag"]})})}),x.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"",children:n("Edit Content")=="1"&&W&&e.jsx(Gt,{viewer_id:I})}),n("Create Content; Edit Content")=="1"&&a.length>0&&a.length===x.length&&W&&e.jsx(e.Fragment,{children:e.jsx("div",{className:"",children:e.jsx(Zt,{})})}),console.log("Selected Items:",x),x.length===1&&x[0].mimetype&&e.jsx(e.Fragment,{children:e.jsx(ta,{})}),!le&&n("View Tag; View All Tag")=="1"&&e.jsx("div",{className:" ",children:e.jsxs("button",{className:"flex items-center text-secondary text-[14px] py-1 px-2 my-2 rounded-md border-solid hover:bg-gray-200 dark:text-gray-200 dark:hover:bg-gray-700 dark:border-gray-500",onClick:async()=>{k(!0),A(Q()),await C("tag","filter","content"),k(!1)},children:[e.jsx(P,{icon:ds,className:"mr-2"}),"Show Tag"]})}),!re&&n("View Pitch; View all Pitch")=="1"&&e.jsx("div",{children:e.jsxs("button",{className:"flex items-center text-secondary text-[14px] py-1 px-2 my-2 rounded-md border-solid hover:bg-gray-200 dark:text-gray-200 dark:hover:bg-gray-700 dark:border-gray-500",onClick:async()=>{k(!0),A(Q()),await C("pitch","filter","content"),k(!1)},children:[e.jsx(P,{icon:ms,className:"mr-2"}),"Show Pitch"]})}),n("Add Content to Tag")=="1"&&x.length===1&&W&&e.jsx("div",{children:e.jsxs("button",{className:"flex items-center text-secondary text-[14px] py-1 px-2 my-2 rounded-md border-solid hover:bg-gray-200 dark:text-gray-200 dark:hover:bg-gray-700 dark:border-gray-500",onClick:()=>{d(!0),A(os({viewer_id:I,baseURL:T}))},children:[e.jsx(P,{icon:cs,className:"mr-2"}),"Add Tag"]})}),e.jsx("div",{className:"transition-all",children:!pe&&n("Delete Content")=="1"&&W&&e.jsx(xs,{inDialog:!1})}),!xe&&n("Download Content")=="1"&&Ce&&e.jsx("div",{className:"transition-all",children:e.jsx(ps,{inDialog:!1})}),x.length>0&&c?e.jsxs("div",{ref:g,className:"absolute top-[120px] left-[45px] mt-2 z-[999] w-[115px] bg-slate-50 dark:bg-gray-800 p-2 rounded-lg shadow-lg flex justify-start items-start flex-col space-y-1",children:[le&&n("View Tag; View All Tag")=="1"&&e.jsx("div",{className:" flex justify-start items-start",children:e.jsxs("button",{className:"flex items-center text-secondary text-[14px] py-1 px-2 my-2 rounded-md border-solid hover:bg-gray-200 dark:text-gray-200 dark:hover:bg-gray-700 dark:border-gray-500",onClick:async()=>{k(!0),A(Q()),await C("tag","filter","content"),k(!1),h(!1)},children:[e.jsx(P,{icon:ds,className:"mr-2"}),"Show Tag"]})}),re&&n("View Pitch; View all Pitch")=="1"&&e.jsx("div",{className:"flex items-start justify-start",children:e.jsxs("button",{className:"text-secondary text-[14px] py-2  pr-3 flex flex-nowrap justify-start items-start tracking-tighter rounded-md border-solid hover:bg-gray-200 dark:text-gray-200 dark:hover:bg-gray-700 dark:border-gray-500",onClick:async()=>{k(!0),A(Q()),await C("pitch","filter","content"),k(!1)},children:[e.jsx(P,{icon:ms,className:"mr-2"}),"Show Pitch"]})}),pe&&n("Delete Content")=="1"&&W&&e.jsx("div",{className:"",children:e.jsx(xs,{inDialog:!0})}),xe&&n("Download Content")=="1"&&Ce&&e.jsx("div",{className:"",children:e.jsx(ps,{inDialog:!0})})]}):""]})]})]})}),e.jsxs("div",{className:"flex gap-4 flex-row items-center flex-nowrap h-10",children:[O&&e.jsx("button",{onClick:fe,className:"shrink-0 select-none transition-all hover:scale-95 active:scale-90",children:e.jsx("img",{className:"w-9",src:gt,alt:""})}),e.jsxs("div",{className:"flex justify-center gap-4 items-center",children:[e.jsx("button",{onClick:ve,className:"flex justify-center items-center border h-[35px] w-[60px] rounded mt-2 border-[#cfcece]",children:r?e.jsx(yt,{className:"h-6 w-6 "}):e.jsx(Rt,{className:"h-6 w-6 "})}),e.jsx(bt,{queryTable:"content"})]})]})]}),e.jsx("div",{children:o&&e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50  justify-center items-center ",children:e.jsxs("div",{ref:se,className:"max-w-[400px] w-full p-5 h-[300px] bg-neutral-200 border rounded-lg border-neutral-100 ",children:[e.jsxs("button",{className:"text-2xl transition-all mr-6 text-neutral-700 active:scale-75",onClick:()=>L(!1),children:[" ",e.jsx(Jt,{})," "]}),e.jsx("button",{className:"px-2 py-1 bg-blue-500 rounded-md text-white border border-blue-400",children:"Edit with Canva"})]})})})]})},na=({isOpen:r,onClose:i,contentPlaceHolders:c})=>{const[h,l]=t.useState(c.length>0?c[0].contentName:null),[w,g]=t.useState(c.length>0?c[0].placeholders:[]),y=n=>{const f=n.target.value,m=c.find(C=>C.contentId===f);m?(l(m.contentName),g(m.placeholders)):(l(null),g([]))};return t.useEffect(()=>{c.length>0&&(l(c[0].contentName),g(c[0].placeholders))},[c]),r?e.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-gray-800 bg-opacity-70 z-[40]",children:e.jsxs("div",{className:"bg-gray-100 rounded-lg shadow-md py-4 w-96 relative",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4 border-b border-gray-300 pb-2 px-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 ",children:"Select Content"}),e.jsx("button",{className:"text-red-600  w-8 h-8",onClick:i,children:e.jsx(P,{icon:Ut})})]}),e.jsxs("div",{className:"px-4",children:[e.jsxs("select",{className:"border border-gray-400 rounded p-2 mb-4 w-full bg-white text-gray-800",onChange:y,defaultValue:c.length>0?c[0].contentId:"",children:[e.jsx("option",{value:"",disabled:!0,children:"Select a content name"}),c==null?void 0:c.map(n=>e.jsx("option",{value:n.contentId,children:n.contentName},n.contentId))]}),h&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold mb-2 text-gray-900",children:["Placeholders for ",e.jsx("span",{className:"font-semibold text-gray-900 underline",children:h})]}),e.jsx("ul",{className:"list-disc list-inside",children:w.map((n,f)=>e.jsx("li",{className:"text-gray-700",children:n},f))})]})]})]})}):null},ja=()=>{const[r,i]=t.useState(!1),{driveSelection:c,viewer_id:h,baseURL:l}=t.useContext(H),w=K(),g=N(d=>d.contents.breadcrumbs);et({}),N(d=>d.contents.selectedItems);const[y,n]=t.useState([]),[f,m]=t.useState(!1),C=d=>{w(st(d)),w(Q()),w(ee({viewer_id:h,folder_id:d[d.length-1].id,baseURL:l}))};return t.useEffect(()=>{const d=()=>{const I=localStorage.getItem("myTils");i(I==="true")};return d(),window.addEventListener("storageUpdated",d),window.addEventListener("storage",d),()=>{window.removeEventListener("storageUpdated",d),window.removeEventListener("storage",d)}},[]),e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx(aa,{}),c&&e.jsx(Bt,{setContentPlaceHolders:n,setContentPlaceHolderModal:m})]}),e.jsx("div",{children:e.jsx(na,{isOpen:f,onClose:()=>m(!1),contentPlaceHolders:y})}),e.jsxs("div",{className:"container mx-auto p-4 ml-auto",children:[e.jsx("div",{children:e.jsx(qe,{viewer_id:h,breadcrumbs:g,onBreadcrumbClick:ze,setBreadcrumbs:C})}),e.jsx("div",{children:e.jsx("div",{children:r?e.jsx(Vt,{viewer_id:h,minCellWidth:120}):e.jsx(vt,{viewer_id:h,minCellWidth:120,setContentPlaceHolders:n,setContentPlaceHolderModal:m})})})]})]})};export{ja as default};
